<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GCSE Focus — Sign In</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg:#0b1020;
  --panel:rgba(255,255,255,.06);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.6);
  --border:rgba(255,255,255,.15);
  --brand:#8ea2ff;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:
    radial-gradient(1200px 700px at 10% 10%, rgba(142,162,255,.25),transparent 60%),
    radial-gradient(900px 600px at 90% 20%, rgba(70,230,179,.15),transparent 55%),
    var(--bg);
  color:var(--text);
  height:100vh;
  display:flex;
}

.left{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:40px;
}

.brand{
  max-width:400px;
}

.brand h1{
  font-size:38px;
  margin:0;
}

.brand p{
  margin-top:12px;
  color:var(--muted);
}

.right{
  width:420px;
  background:var(--panel);
  backdrop-filter:blur(20px);
  border-left:1px solid var(--border);
  display:flex;
  flex-direction:column;
  justify-content:center;
  padding:40px;
}

input{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:transparent;
  color:white;
}

button{
  width:100%;
  padding:12px;
  margin-top:14px;
  border:none;
  border-radius:10px;
  background:linear-gradient(135deg,#8ea2ff,#46e6b3);
  font-weight:bold;
  cursor:pointer;
}

.link{
  margin-top:14px;
  text-align:center;
  font-size:14px;
  color:var(--muted);
  cursor:pointer;
}

.link:hover{
  color:white;
}

.hidden{display:none;}

.message{
  margin-top:12px;
  font-size:14px;
  text-align:center;
  color:#ff7b8f;
}
</style>
</head>

<body>

<div class="left">
  <div class="brand">
    <h1>GCSE Focus</h1>
    <p>Study Sets • Flashcards • Learn • Test • Revision • AI</p>
  </div>
</div>

<div class="right">
  <div id="signin">
    <h2>Sign In</h2>
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button onclick="signIn()">Sign In</button>
    <div class="link" onclick="showSignup()">Create account</div>
    <div class="link" onclick="showReset()">Forgot password?</div>
    <div id="signinMsg" class="message"></div>
  </div>

  <div id="signup" class="hidden">
    <h2>Create Account</h2>
    <input id="signupEmail" type="email" placeholder="Email">
    <input id="signupPassword" type="password" placeholder="Password">
    <button onclick="signUp()">Create Account</button>
    <div class="link" onclick="showSignin()">Back to sign in</div>
    <div id="signupMsg" class="message"></div>
  </div>

  <div id="reset" class="hidden">
    <h2>Reset Password</h2>
    <input id="resetEmail" type="email" placeholder="Email">
    <button onclick="resetPassword()">Send Reset Link</button>
    <div class="link" onclick="showSignin()">Back to sign in</div>
    <div id="resetMsg" class="message"></div>
  </div>
</div>

<script>
const SUPABASE_URL = "https://mgpwknnbhaljsscsvucm.supabase.co";
const SUPABASE_KEY = "sb_publishable_6tdnozSH6Ck75uDgXPN-sg_Mn7vyLFs";

const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// Auto redirect if already logged in
document.addEventListener("DOMContentLoaded", async () => {
  const { data: { session } } = await supabaseClient.auth.getSession();
  if (session) {
    window.location.href = "index.html";
  }
});

function showSignup(){
  signin.classList.add("hidden");
  reset.classList.add("hidden");
  signup.classList.remove("hidden");
}

function showSignin(){
  signup.classList.add("hidden");
  reset.classList.add("hidden");
  signin.classList.remove("hidden");
}

function showReset(){
  signin.classList.add("hidden");
  signup.classList.add("hidden");
  reset.classList.remove("hidden");
}

async function signIn(){
  const { error } = await supabaseClient.auth.signInWithPassword({
    email: email.value,
    password: password.value
  });

  if(error){
    signinMsg.textContent = error.message;
  } else {
    window.location.href = "index.html";
  }
}

async function signUp(){
  const { error } = await supabaseClient.auth.signUp({
    email: signupEmail.value,
    password: signupPassword.value
  });

  if(error){
    signupMsg.textContent = error.message;
  } else {
    signupMsg.style.color = "#46e6b3";
    signupMsg.textContent = "Account created. You can now sign in.";
  }
}

async function resetPassword(){
  const { error } = await supabaseClient.auth.resetPasswordForEmail(resetEmail.value, {
    redirectTo: window.location.origin + "/auth.html"
  });

  if(error){
    resetMsg.textContent = error.message;
  } else {
    resetMsg.style.color = "#46e6b3";
    resetMsg.textContent = "Reset email sent.";
  }
}
</script>
<footer style="
  margin-top:40px;
  padding:20px;
  text-align:center;
  font-size:14px;
  opacity:.6;
">
  <a href="privacy.html">Privacy Policy</a> |
  <a href="terms.html">Terms of Service</a>
</footer>
</body>
</html>