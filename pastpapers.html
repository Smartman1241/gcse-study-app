<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GCSE Focus ‚Äì AQA Past Papers</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg:#0b1020;
  --glass:rgba(255,255,255,.08);
  --border:rgba(255,255,255,.15);
  --text:rgba(255,255,255,.92);
  --brand:#8ea2ff;
}

body{
  margin:0;
  min-height:100vh;
  font-family:system-ui;
  background:
    radial-gradient(1000px 600px at 15% 10%, rgba(142,162,255,.25), transparent 60%),
    radial-gradient(900px 500px at 85% 20%, rgba(70,230,179,.18), transparent 55%),
    radial-gradient(900px 500px at 70% 90%, rgba(255,211,110,.14), transparent 55%),
    var(--bg);
  display:flex;
  justify-content:center;
  align-items:center;
  color:var(--text);
}

.container{
  width:100%;
  max-width:700px;
  padding:30px;
}

.card{
  backdrop-filter:blur(20px);
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:22px;
  padding:40px;
  box-shadow:0 20px 60px rgba(0,0,0,.35);
}

h1{
  text-align:center;
  margin-bottom:30px;
  font-size:28px;
}

label{
  display:block;
  margin-top:18px;
  font-weight:600;
}

select{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:12px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:white;
  font-size:15px;
}

button{
  width:100%;
  padding:14px;
  margin-top:25px;
  border-radius:14px;
  border:none;
  background:var(--brand);
  font-weight:700;
  cursor:pointer;
  font-size:15px;
}

.back{
  background:rgba(255,255,255,.08);
  margin-top:15px;
}

.results{
  margin-top:30px;
  padding:20px;
  border-radius:16px;
  background:rgba(255,255,255,.05);
  border:1px solid var(--border);
}

a{
  display:block;
  margin-top:12px;
  color:var(--brand);
  font-weight:600;
  text-decoration:none;
}
</style>
</head>

<body>

<div class="container">
  <div class="card">

    <h1>AQA Past Papers</h1>

    <label>Subject</label>
    <select id="subject" onchange="updatePaperOptions()">
      <option value="english-language">English Language</option>
      <option value="english-literature">English Literature</option>
      <option value="biology">Biology</option>
      <option value="chemistry">Chemistry</option>
      <option value="physics">Physics</option>
      <option value="maths">Maths</option>
    </select>

    <label>Paper</label>
    <select id="paper"></select>

    <label>Tier</label>
    <select id="tier">
      <option value="foundation">Foundation</option>
      <option value="higher">Higher</option>
    </select>

    <label>Year</label>
    <select id="year">
      <option>2024</option>
      <option>2023</option>
      <option>2022</option>
      <option>2021</option>
      <option>2020</option>
    </select>

    <button onclick="findPaper()">Find Paper</button>

    <div class="results" id="results" style="display:none;"></div>

    <button class="back" onclick="window.location.href='index.html'">
      ‚Üê Back to Dashboard
    </button>

  </div>
</div>

<script>
const SUPABASE_URL = "https://mgpwknnbhaljsscsvucm.supabase.co";
const SUPABASE_KEY = "sb_publishable_6tdnozSH6Ck75uDgXPN-sg_Mn7vyLFs";
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

function updatePaperOptions(){
  const subject = document.getElementById("subject").value;
  const paperSelect = document.getElementById("paper");
  paperSelect.innerHTML = "";

  if(subject === "maths"){
    paperSelect.innerHTML = `
      <option value="paper-1-non-calculator">Paper 1 Non-Calculator</option>
      <option value="paper-2-calculator">Paper 2 Calculator</option>
      <option value="paper-3-calculator">Paper 3 Calculator</option>
    `;
  } else {
    paperSelect.innerHTML = `
      <option value="paper-1">Paper 1</option>
      <option value="paper-2">Paper 2</option>
    `;
  }
}

async function findPaper(){

  const subject = document.getElementById("subject").value;
  const paper_type = document.getElementById("paper").value;
  const tier = document.getElementById("tier").value;
  const year = parseInt(document.getElementById("year").value);

  const results = document.getElementById("results");
  results.style.display = "block";
  results.innerHTML = "Searching...";

  const { data, error } = await supabaseClient
    .from("past_papers")
    .select("*")
    .eq("subject", subject)
    .eq("paper_type", paper_type)
    .eq("tier", tier)
    .eq("year", year)
    .single();

  if(error || !data){
    results.innerHTML = "Paper not found in database.";
    return;
  }

  results.innerHTML = `
    <h3>${year} ${subject.replace("-", " ").toUpperCase()} (${tier})</h3>
    <a href="${data.question_link}" target="_blank">üìÑ View Official Paper</a>
    <a href="${data.markscheme_link}" target="_blank">üìù View Mark Scheme</a>
  `;
}

updatePaperOptions();
</script>

</body>
</html>