<!doctype html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FocusGCSE â€” Home</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg:#0b1020;
  --panel:rgba(255,255,255,.06);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.66);
  --border:rgba(255,255,255,.14);
  --radius:18px;
  --shadow:0 18px 60px rgba(0,0,0,.35);
  --btn:rgba(255,255,255,.10);
  --btn2:rgba(255,255,255,.14);
}
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  color:var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background:
    radial-gradient(1200px 700px at 12% 10%, rgba(142,162,255,.25),transparent 60%),
    radial-gradient(900px 600px at 86% 22%, rgba(70,230,179,.18),transparent 55%),
    var(--bg);
}
.wrap{max-width:980px; margin:0 auto; padding:28px 18px}
.card{
  padding:20px;
  border:1px solid var(--border);
  border-radius:var(--radius);
  background:var(--panel);
  box-shadow:var(--shadow);
}
.muted{color:var(--muted)}
.row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
.btn{
  border:1px solid var(--border);
  background:var(--btn);
  color:var(--text);
  padding:10px 14px;
  border-radius:12px;
  cursor:pointer;
}
.btn:hover{background:var(--btn2)}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-top:14px;
}
@media (max-width:860px){ .grid{grid-template-columns:1fr} }
</style>
</head>

<body>
<div class="wrap">

<div class="card">
  <h1 id="hello">Welcome back</h1>
  <div class="muted">Letâ€™s pick up where you left off.</div>

  <div class="row">
    <button class="btn" id="btnContinue">Continue</button>
    <button class="btn" id="btnDashboard">Dashboard</button>
    <button class="btn" id="btnLogout">Logout</button>
  </div>
</div>

<div class="grid">
  <div class="card">
    <h3>Jump straight in</h3>
    <div class="row">
      <button class="btn go" data-url="index.html#tasks">Tasks</button>
      <button class="btn go" data-url="index.html#studysets">Study Sets</button>
      <button class="btn go" data-url="index.html#flashcards">Flashcards</button>
      <button class="btn go" data-url="index.html#ai">AI</button>
      <button class="btn go" data-url="pastpapers.html">Past Papers</button>
    </div>
  </div>

  <div class="card">
    <h3>Next up</h3>
    <div class="muted">
      Weâ€™ll soon show your last session here.
    </div>
  </div>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {

  const SUPABASE_URL = "https://mgpwknnbhaljsscsvucm.supabase.co";
  const SUPABASE_ANON_KEY = "sb_publishable_6tdnozSH6Ck75uDgXPN-sg_Mn7vyLFs";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const CONTINUE_KEY = "focusgcse:last_url";
  const DEFAULT_PAGE = "index.html";

  // ðŸ” Protect page
  const { data: { session } } = await supabase.auth.getSession();

  if (!session) {
    window.location.href = "start.html";
    return;
  }

  const user = session.user;
  document.getElementById("hello").textContent =
    `Welcome back, ${user.user_metadata?.full_name || user.email}`;

  // Continue
  document.getElementById("btnContinue").onclick = () => {
    const last = localStorage.getItem(CONTINUE_KEY) || DEFAULT_PAGE;
    window.location.href = last;
  };

  // Dashboard
  document.getElementById("btnDashboard").onclick = () => {
    window.location.href = "index.html";
  };

  // Logout
  document.getElementById("btnLogout").onclick = async () => {
    await supabase.auth.signOut();
    localStorage.removeItem(CONTINUE_KEY);
    window.location.href = "start.html";
  };

  // Jump buttons
  document.querySelectorAll(".go").forEach(btn => {
    btn.onclick = () => {
      const url = btn.dataset.url;
      localStorage.setItem(CONTINUE_KEY, url);
      window.location.href = url;
    };
  });

});
</script>

</body>
</html>